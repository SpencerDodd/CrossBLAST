# CrossBLAST
##### Author: Spencer Dodd
##### Affiliation: Northeastern University

This is a rough script that I have been using to do genomic research with automated BLAST queries. If you've stumbled on this page, please don't judge the code...I know it's gross and some of it is pretty spaghetti. I'm working on cleaning and fixing it up now, but that's taking a backseat to data generation at the moment.

## Overview

Here's a quick rundown of what each script does, and future functionality that it will have in coming iterations.

#### blast_accession.py

This is the workhouse of the scripts. And the most spaghetti. It is run with the following command and arguments:

--------------------------------------------------------
```
python blast_accession.py INPUT_TYPE QUERY_DATABASE QUERY_SPECIES_NAME QUERY_SUBSPECIES_NAME QUERY_ACCESSION_NUMBER
```

where...

```INPUT_TYPE``` is the style in which the query data will be given to the script

  + a: accession number

  + f: FASTA file

  + cross: cross_blast request (not applicable for shell use, but will be elaborated later)

```QUERY_DATABASE``` is any of the NCBI's publicly available databases 

  + human_genomic

  + nt

  + refseq_genomic

  + etc...

```QUERY_SPECIES``` is the name of the species of the organism the query sequence belongs to

  + This is used due to the fact that the NCBI's API only returns phylogenetic information up to the genus level. This value is used to regex match with hits to determine level of relatedness past the genus level

```QUERY_SUBSPECIES``` is the name of the subspecies of the organism the query sequence belongs to

  + This is used for the same reason as QUERY_SPECIES

```QUERY_ACCESSION_NUMBER``` is the accession number of the query sequence

  + This is only a necessary input if you are using an accession number based query. (and in cross_blast queries)
--------------------------------------------------------

This script queries the NCBI's BLAST servers to look for sequence hits in the inputted database using the blastn algorithm. It outputs the hit information in .csv format delineated by the Family, SubFamily, Genus, Species, and Subspecies phylogenetic levels. 

One important facet of the data analysis is that the % difference field in the output is actually the % difference between the query and hit / 2. This finds the distance to closest common ancestor between the hit and query.

#### cross_blast.py

This is an extension of functionality and scope of the original ```blast_accession.py``` script. It is run with the following commands and arguments:

--------------------------------------------------------
```
python cross_blast.py QUERY_DATABASE
```

```QUERY_DATABASE``` is the same as defined in ```blast_accession.py```
--------------------------------------------------------

This script works off of one set of ```blast_accession.py``` results. After executing in shell, it will prompt a file browsing window. With this, you want to select the result file of the phylogenetic level of relationships to the query you are interested in exploring. At this point in time, it supports just the species results (I believe).

What this does is examine all possible combinations of BLAST queries (queries for all members of the original species hits). This outputs a data set that contains the uppermost and lowermost bounds for distances to common ancestor for the phylogenetic level of interest in relation to the original query sequence. 

#### hits_from_excel.R

This script is a hacky little R script for data visualization (used for data integrity checks). It doesn't really need to be delved into further, and will probably be replaced in the near future with either an integrated python script with the same functionality.

### Future Implementations / Upgrades

The end goal of this script set is an all in one application that requires one input and results in orderly, properly formatted results with relevant autogenerated figures and data analytics. As of now, I don't have the time to do this, although it would be simple. I'll get on it after exams.











